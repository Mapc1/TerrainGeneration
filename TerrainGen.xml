<?xml version="1.0" encoding="UTF-8"?>
<project name="Terrain Generation VTR 24" width="1280" height="720">
  <assets>
    <attributes>
      <attribute type="STATE" name="OCTAVES" data="INT" value="1"/>
      <attribute type="STATE" name="STARTING_AMPLITUDE" data="FLOAT" value="1.0"/>
      <attribute type="STATE" name="STARTING_FREQ" data="FLOAT" value="0.01"/>
      <attribute type="STATE" name="GAIN" data="FLOAT" value="0.5"/>
      <attribute type="STATE" name="LACUNARITY" data="FLOAT" value="2.0"/>
    </attributes>

    <scenes>
      <scene name="Skybox">
        <geometry name="Skybox" type="BOX" material="Skybox">
          <SCALE x="1000" y="1000" z="1000"/>
        </geometry>
      </scene>

      <scene name="Plane">
        <geometry name="plane" type="GRID" material="Plane" LENGTH="1024" DIVISIONS="1024"/>
      </scene>
    </scenes>

    <viewports>
      <viewport name="MainViewport">
        <CLEAR_COLOR r="0.0" g="0.0" b="0.0"/>
      </viewport>
    </viewports>

    <cameras>
      <camera name="MainCamera">
        <viewport name="MainViewport"/>
        <POSITION x="0.402" y="0.974" z="1.341" />
        <LOOK_AT_POINT x="0" y="0" z="0" />
        <NEAR value="0.01" />
        <FAR value="5000"/>
      </camera>
    </cameras>

    <lights>
      <light name="Sun">
        <DIRECTION x="0.2" y="-0.8" z="0.0"/>
        <COLOR r="1.0" g="1.0" b="1.0"/>
      </light>
    </lights>

    <materialLibs>
      <materialLib filename="TerrainGen.mlib"/>
    </materialLibs>
  </assets>

  <pipelines default="TerrainGen">
    <pipeline name="TerrainGen" defaultCamera="MainCamera">
      <pass class="compute" name="GenContinental">
        <material name="GenContinental" fromLibrary="TerrainGen" dimX="1024" dimY="1024" dimZ="1"/>
      </pass>

      <pass class="compute" name="GenDisplacement">
        <material name="GenDisplacement" fromLibrary="TerrainGen" dimX="1024" dimY="1024" dimZ="1"/>
      </pass>

      <pass class="depthmap" name="GenShadowMap">
        <scenes>
          <scene name="Plane"/>
        </scenes>
        <camera name="MainCamera"/>
        <lights>
          <light name="Sun"/>
        </lights>
        <renderTarget name="ShadowMap" fromLibrary="TerrainGen"/>
        <materialMaps>
          <map fromMaterial="Plane" toLibrary="TerrainGen" toMaterial="Terrain"/>
        </materialMaps>
      <injectionMaps>
        <map toMaterial="*">
          <shader fromMaterial="GenShadowMap" fromLibrary="TerrainGen"/>
        </map>
      </injectionMaps>
      </pass>

      <pass name="Render">
        <scenes>
          <scene name="Plane"/>
          <scene name="Skybox"/>
        </scenes>
        <lights>
          <light name="Sun"/>
        </lights>
        <camera name="MainCamera"/>

        <injectionMaps>
          <map toMaterial="*">
            <shader fromMaterial="Terrain" fromLibrary="TerrainGen"/>
            <textures>
              <texture name="DisplacementMap" fromLibrary="TerrainGen" toUnit="0">
                <MIN_FILTER value="LINEAR"/>
                <MAG_FILTER value="LINEAR"/>
              </texture>
            </textures>
          </map>
        </injectionMaps>
        <materialMaps>
          <map fromMaterial="Plane" toLibrary="TerrainGen" toMaterial="Terrain"/>
          <map fromMaterial="Skybox" toLibrary="TerrainGen" toMaterial="Skybox"/>
        </materialMaps>
      </pass>
    </pipeline>

    <pipeline name="NoiseVisualization">
      <pass class="compute" name="GenContinental">
        <material name="GenContinental" fromLibrary="TerrainGen" dimX="1024" dimY="1024" dimZ="1"/>
      </pass>

      <pass class="quad" name="DisplayContinentalTexture">
        <viewport name="MainViewport"/>
        <material name="DisplayContinentalTexture" fromLibrary="TerrainGen"/>
      </pass>
    </pipeline>
  </pipelines>

  <interface>
    <window label="Continental Parameters">
      <var label="Number of octaves" type="STATE" context="TerrainGen::GenContinental" component="OCTAVES" def="min=1 max=10"/>
      <var label="Starting amplitude" type="STATE" context="TerrainGen::GenContinental" component="STARTING_AMPLITUDE" def="min=0.0001 max=10"/>
      <var label="Starting frequency" type="STATE" context="TerrainGen::GenContinental" component="STARTING_FREQ" def="min=0.0001 max=3"/>
      <var label="Gain" type="STATE" context="TerrainGen::GenContinental" component="GAIN" def="min=0.0001 max=3"/>
      <var label="Lacunarity" type="STATE" context="TerrainGen::GenContinental" component="LACUNARITY" def="min=0.0001 max=3"/>
      </window>
      <window label="Other settings">
        <pipelineList label="Pipeline list"/>
      </window>
  </interface>
</project>